getCustomerSubsById = SELECT cs.* ,pm.PRODUCT_NAME, pm.PRODUCT_IMAGE, pm.PRODUCT_UOM, pm.product_desc, lso.offer_code \
FROM LT_CUSTOMER_SUBS cs LEFT JOIN LT_PRODUCTS pm ON cs.PRODUCT_ID = pm.PRODUCT_ID \
LEFT JOIN  lt_subscription_offer lso ON  cs.OFFER_ID = lso.OFFER_ID  \
WHERE cs.SUBS_ID = ?

getNextDeliveriesBySupplier = select lcsd.delivery_date,sum(lcsd.delivery_quantity) SUBS_QUANTITY,lcsd.product_id , \
			lp.product_name,lcs.delivery_time  \
		from lt_customer_subs_deliveries lcsd , lt_products lp,lt_customer_subs lcs \
			where lcsd.supplier_id = ? \
				and lcsd.product_id = lp.product_id  \
				and lcsd.subs_id =lcs.subs_id \
				and lcs.supplier_id = lcsd.supplier_id \
				and lcsd.delivery_date = ?  \
				and  lcs.delivery_time = ?  \
				AND lcsd.SUBS_QUANTITY > 0 \
				and (lcsd.delivery_quantity > 0 OR lcsd.status = 'CANCELLED') \
		group by lcsd.delivery_date,lcsd.product_id,lp.product_name,lcs.delivery_time  \
		order by lp.product_name
		
getNextDeliveriesBySupplier_old = select lcsd.delivery_date,sum(lcsd.SUBS_QUANTITY) SUBS_QUANTITY,lcsd.product_id , \
			lp.product_name,lcs.delivery_time  \
		from lt_customer_subs_deliveries lcsd , lt_products lp,lt_customer_subs lcs \
			where lcsd.supplier_id = ? \
				and lcsd.product_id = lp.product_id  \
				and lcsd.subs_id =lcs.subs_id \
				and lcs.supplier_id = lcsd.supplier_id \
				and lcsd.delivery_date = ?  \
				and  lcs.delivery_time = ?  and lcsd.SUBS_QUANTITY > 0 \
		group by lcsd.delivery_date,lcsd.product_id,lp.product_name,lcs.delivery_time  \
		order by lp.product_name
																						
getAllActiveCustomerSubsByUser_old = SELECT cs.SUPPLIER_ID,cs.SUBS_ID,cs.USER_ID,cs.SUBS_QUANTITY,cs.DELIVERY_TIME,cs.SUBS_DELIVERY_DATE, \
cs.SUBSCRIPTION_TYPE,cs.CUSTOMER_RATE,cs.DELIVERY_MODE,cs.STATUS,case when cs.status = 'PENDING' then 1 \
          when cs.status = 'ACTIVE' then 2 \
          else 3 end status_order, \
cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE ,pm.PRODUCT_NAME,pm.PRODUCT_IMAGE,pm.PRODUCT_UOM,cs.ALTERNATE_DAY, \
cs.MONDAY,cs.TUESDAY,cs.WEDNESDAY,cs.THURSDAY,cs.FRIDAY,cs.SATURDAY,cs.SUNDAY,cs.START_DATE,cs.OFFER_ID  \
FROM LT_CUSTOMER_SUBS cs LEFT JOIN LT_PRODUCTS pm ON cs.PRODUCT_ID = pm.PRODUCT_ID  \
WHERE cs.USER_ID = ? AND cs.SUBSCRIPTION_TYPE = 'MONTHLY' AND cs.STATUS NOT IN ('CANCELLED','REJECTED') \
ORDER BY status_order

getAllActiveCustomerSubsByUser = SELECT cs.SUPPLIER_ID,cs.SUBS_ID,cs.USER_ID,cs.SUBS_QUANTITY \
	 , cs.delivery_time \
	  , concat(cs.delivery_time, ' (', to_char(from_time,'HH:MI AM'),'-', to_char(to_time,'HH:MI PM'), ')') as show_time \
	 , cs.SUBS_DELIVERY_DATE \
	  ,cs.SUBSCRIPTION_TYPE \
	  ,cs.CUSTOMER_RATE \
	  ,cs.DELIVERY_MODE \
	  ,cs.STATUS,case when cs.status = 'PENDING' then 1 \
	          when cs.status = 'ACTIVE' then 2 \
	          else 3 end status_order, \
	cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE ,pm.PRODUCT_NAME,pm.PRODUCT_IMAGE,pm.PRODUCT_UOM,cs.ALTERNATE_DAY, \
	cs.MONDAY,cs.TUESDAY,cs.WEDNESDAY,cs.THURSDAY,cs.FRIDAY,cs.SATURDAY,cs.SUNDAY,cs.START_DATE,cs.OFFER_ID  \
	FROM LT_CUSTOMER_SUBS cs, LT_PRODUCTS pm, lt_supplier_delivery_timings sdt \
	WHERE  1 = 1 \
	and sdt.supplier_id = cs.supplier_id \
	and Upper(sdt.delivery_time) = Upper(cs.delivery_time) \
	AND cs.PRODUCT_ID = pm.PRODUCT_ID \
	AND cs.SUBSCRIPTION_TYPE = 'MONTHLY' \
	AND cs.STATUS NOT IN ('CANCELLED','REJECTED') \
	and cs.USER_ID = ? \
	ORDER BY status_order
	
getAllActiveCustomerSubsByUser_count_v1 = SELECT count (cs.SUBS_ID)   \
	FROM LT_CUSTOMER_SUBS cs \
	WHERE  1 = 1 \
	and cs.USER_ID = ? \
	AND cs.SUBSCRIPTION_TYPE = 'MONTHLY'	
	
getAllActiveCustomerSubsByUser_v1 = SELECT cs.SUPPLIER_ID,cs.SUBS_ID,cs.USER_ID,cs.SUBS_QUANTITY \
	 , cs.delivery_time \
	  , concat(cs.delivery_time, ' (', to_char(from_time,'HH:MI AM'),'-', to_char(to_time,'HH:MI PM'), ')') as show_time \
	 , cs.SUBS_DELIVERY_DATE \
	  ,cs.SUBSCRIPTION_TYPE \
	  ,cs.CUSTOMER_RATE \
	  ,cs.DELIVERY_MODE \
	  ,cs.STATUS,case when cs.status = 'PENDING' then 4 \
	          when cs.status = 'ACTIVE' then 3 \
	          when cs.status = 'CANCELLED' then 2 \
	          when cs.status = 'REJECTED' then 1 \
	          else 0 end status_order, \
	cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE ,pm.PRODUCT_NAME,pm.PRODUCT_IMAGE,pm.PRODUCT_UOM,cs.ALTERNATE_DAY, \
	cs.MONDAY,cs.TUESDAY,cs.WEDNESDAY,cs.THURSDAY,cs.FRIDAY,cs.SATURDAY,cs.SUNDAY,cs.START_DATE,cs.OFFER_ID  \
	FROM LT_CUSTOMER_SUBS cs, LT_PRODUCTS pm, lt_supplier_delivery_timings sdt \
	WHERE  1 = 1 \
	and sdt.supplier_id = cs.supplier_id \
	and Upper(sdt.delivery_time) = Upper(cs.delivery_time) \
	AND cs.PRODUCT_ID = pm.PRODUCT_ID \
	AND cs.SUBSCRIPTION_TYPE = 'MONTHLY' \
	and cs.USER_ID = ? \
	ORDER BY status_order desc, cs.last_update_date desc


 getAllActiveDeliveryOnceByUser = SELECT cs.SUPPLIER_ID \
	 , cs.SUBS_ID,cs.USER_ID,cs.SUBS_QUANTITY \
	 , cs.delivery_time \
	  , concat(cs.delivery_time, ' (', to_char(from_time,'HH:MI AM'),'-', to_char(to_time,'HH:MI PM'), ')') as show_time  \
	 , cs.SUBS_DELIVERY_DATE \
	  ,cs.SUBSCRIPTION_TYPE \
	  ,cs.CUSTOMER_RATE \
	  ,cs.DELIVERY_MODE  \
	  ,cs.STATUS,  \
	cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE ,pm.PRODUCT_NAME,pm.PRODUCT_IMAGE,pm.PRODUCT_UOM,cs.ALTERNATE_DAY,  \
	cs.MONDAY,cs.TUESDAY,cs.WEDNESDAY,cs.THURSDAY,cs.FRIDAY,cs.SATURDAY,cs.SUNDAY,cs.START_DATE,cs.OFFER_ID   \
	FROM LT_CUSTOMER_SUBS cs, LT_PRODUCTS pm, lt_supplier_delivery_timings sdt \
	WHERE  1 = 1  \
	and sdt.supplier_id = cs.supplier_id  \
	and Upper(sdt.delivery_time) = Upper(cs.delivery_time) \
	AND cs.PRODUCT_ID = pm.PRODUCT_ID  \
	AND cs.SUBSCRIPTION_TYPE = 'ONCE'  \
    AND (cs.STATUS = 'PENDING' OR (cs.STATUS = 'ACTIVE' \
	   and  subs_id in  (select  subs_id  from lt_customer_subs_deliveries lcsd where lcsd.status = 'ACTIVE'))) \
	and cs.USER_ID = ? \
	ORDER by start_date 

getAllActiveDeliveryOnceByUser_count_v1 = SELECT  count(cs.SUBS_ID) \
    FROM LT_CUSTOMER_SUBS cs  WHERE  1 = 1 and cs.USER_ID = ? \
	AND cs.SUBSCRIPTION_TYPE = 'ONCE'

 getAllActiveDeliveryOnceByUser_v1 = select a.*, case when a.status = 'PENDING' then 4 \
	          when a.status = 'ACTIVE' then 3  \
	          when a.status = 'CANCELLED' then 2 \
	          when a.status = 'REJECTED' then 1  \
	          else 0 end status_order \
	  from ( SELECT cs.SUPPLIER_ID  \
	 , cs.SUBS_ID, cs.USER_ID, cs.SUBS_QUANTITY \
	 , cs.delivery_time  \
	  , concat(cs.delivery_time, ' (', to_char(from_time,'HH:MI AM'),'-', to_char(to_time,'HH:MI PM'), ')') as show_time \
	 , cs.SUBS_DELIVERY_DATE  \
	  ,cs.SUBSCRIPTION_TYPE  \
	  ,cs.CUSTOMER_RATE  \
	  ,cs.DELIVERY_MODE   \
	  , cs.last_update_date \
	  ,   case when cs.STATUS = 'ACTIVE' \
	         then (select  status  from lt_customer_subs_deliveries lcsd \
	             where lcsd.subs_id = cs.subs_id and lcsd.supplier_id = cs.supplier_id )  \
	       else cs.STATUS end status    \
	, cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE ,pm.PRODUCT_NAME,pm.PRODUCT_IMAGE,pm.PRODUCT_UOM,cs.ALTERNATE_DAY, \
	cs.MONDAY,cs.TUESDAY,cs.WEDNESDAY,cs.THURSDAY,cs.FRIDAY,cs.SATURDAY,cs.SUNDAY,cs.START_DATE,cs.OFFER_ID   \
	FROM LT_CUSTOMER_SUBS cs, LT_PRODUCTS pm, lt_supplier_delivery_timings sdt  \
	WHERE  1 = 1   \
	and sdt.supplier_id = cs.supplier_id \
	and Upper(sdt.delivery_time) = Upper(cs.delivery_time) \
	AND cs.PRODUCT_ID = pm.PRODUCT_ID   \
	AND cs.SUBSCRIPTION_TYPE = 'ONCE'  \
    and cs.USER_ID = ? \
	) a	  \
	ORDER by  status_order desc, last_update_date desc 


getsubscriptionproduct = SELECT distinct  cs.PRODUCT_ID, pm.PRODUCT_NAME,  pm.PRODUCT_UOM  \
	FROM LT_CUSTOMER_SUBS cs LEFT JOIN LT_PRODUCTS pm ON cs.PRODUCT_ID = pm.PRODUCT_ID	\
	where 1=1 	\
	and cs.USER_ID = ? \
	and cs.supplier_id = ? \
	AND cs.STATUS NOT IN ('REJECTED', 'PENDING')


getAllActiveSubsByUser = SELECT cs.*, pm.PRODUCT_NAME, pm.PRODUCT_IMAGE, pm.PRODUCT_UOM \
FROM LT_CUSTOMER_SUBS cs LEFT JOIN LT_PRODUCTS pm ON cs.PRODUCT_ID = pm.PRODUCT_ID  \
WHERE cs.USER_ID = ? \
  and cs.delivery_mode IS NOT null \
  and cs.subs_quantity  > 0 \
  AND cs.SUBSCRIPTION_TYPE = 'MONTHLY' \
  AND cs.STATUS IN ('ACTIVE')

getAllActiveCustomerSubsByUserForInvoice = SELECT cs.SUPPLIER_ID,cs.SUBS_ID,cs.USER_ID,cs.SUBS_QUANTITY,cs.DELIVERY_TIME, \
cs.SUBS_DELIVERY_DATE, cs.SUBSCRIPTION_TYPE,cs.STATUS, cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE ,pm.PRODUCT_NAME,pm.PRODUCT_IMAGE, \
pm.PRODUCT_UOM,cs.MONDAY,cs.TUESDAY,cs.WEDNESDAY,cs.THURSDAY,cs.FRIDAY,cs.SATURDAY,cs.SUNDAY,cs.START_DATE,cs.OFFER_ID   \
FROM LT_CUSTOMER_SUBS cs LEFT JOIN LT_PRODUCTS pm ON cs.PRODUCT_ID = pm.PRODUCT_ID  \
WHERE cs.USER_ID = ? AND cs.SUBSCRIPTION_TYPE IN ('MONTHLY','ONCE') AND cs.STATUS NOT IN ('REJECTED','PENDING')

getAllActiveSubsBySupplier = SELECT cs.SUPPLIER_ID,cs.SUBS_ID,cs.USER_ID,cs.SUBS_QUANTITY,cs.DELIVERY_TIME, \
cs.SUBSCRIPTION_TYPE,cs.STATUS,cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE ,pm.PRODUCT_NAME,pm.PRODUCT_IMAGE,pm.PRODUCT_UOM,  \
cs.MONDAY,cs.TUESDAY,cs.WEDNESDAY,cs.THURSDAY,cs.FRIDAY,cs.SATURDAY,cs.SUNDAY,cs.START_DATE  \
FROM LT_CUSTOMER_SUBS cs LEFT JOIN LT_PRODUCTS pm ON cs.PRODUCT_ID = pm.PRODUCT_ID   \
WHERE cs.supplier_id = ? AND cs.status = 'ACTIVE'


getAllCustomerSubs = SELECT cs.USER_ID,cs.SUPPLIER_ID,cs.SUBS_ID,cs.SUBS_QUANTITY,cs.DELIVERY_TIME,cs.SUBSCRIPTION_TYPE, \
cs.STATUS,cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE ,pm.PRODUCT_NAME,cs.MONDAY,cs.TUESDAY,cs.WEDNESDAY,cs.THURSDAY, \
cs.FRIDAY,cs.SATURDAY,cs.SUNDAY , cs.START_DATE, cs.END_DATE,um.USER_NAME,pm.PRODUCT_UOM   \
FROM LT_CUSTOMER_SUBS cs ,LT_PRODUCTS pm,LT_MAST_USERS um \
where cs.PRODUCT_ID = pm.PRODUCT_ID \
AND cs.USER_ID = um.USER_ID  \
and cs.SUPPLIER_ID = ?  AND cs.STATUS = 'PENDING' ORDER BY cs.SUBS_ID DESC

getAllSubsByUserId = SELECT cs.USER_ID,cs.SUPPLIER_ID,cs.SUBS_ID,cs.SUBS_QUANTITY,cs.DELIVERY_TIME,cs.SUBSCRIPTION_TYPE, \
cs.STATUS,cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE ,pm.PRODUCT_NAME,cs.MONDAY,cs.TUESDAY,cs.WEDNESDAY,cs.THURSDAY,  \
cs.FRIDAY,cs.SATURDAY,cs.SUNDAY , cs.START_DATE, cs.END_DATE,um.USER_NAME,pm.PRODUCT_UOM ,pm.product_image   \
FROM LT_CUSTOMER_SUBS cs ,LT_PRODUCTS pm,LT_MAST_USERS um  \
where cs.PRODUCT_ID = pm.PRODUCT_ID  \
AND cs.USER_ID = um.USER_ID   \
and um.user_id = ? AND cs.STATUS = COALESCE(?, cs.STATUS) ORDER BY cs.SUBS_ID desc

getMonthlyWeeklyCustomerSubs = SELECT cs.USER_ID, cs.SUPPLIER_ID, cs.SUBS_ID, cs.SUBS_QUANTITY, cs.DELIVERY_TIME, cs.SUBSCRIPTION_TYPE, \
	cs.STATUS, cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE , pm.PRODUCT_NAME, cs.MONDAY, cs.TUESDAY, cs.WEDNESDAY, cs.THURSDAY, \
	cs.FRIDAY, cs.SATURDAY, cs.SUNDAY , cs.START_DATE, cs.END_DATE, um.USER_NAME, pm.PRODUCT_UOM \
FROM LT_CUSTOMER_SUBS cs , \
	LT_PRODUCTS pm, \
	LT_MAST_USERS um \
where cs.PRODUCT_ID = pm.PRODUCT_ID \
AND cs.USER_ID = um.USER_ID \
and cs.SUPPLIER_ID = ?  \
AND cs.STATUS = 'PENDING' \
ORDER BY cs.SUBS_ID DESC

getSubsDeliveryBySubsId = SELECT DELIVERY_ID,DELIVERY_DATE,PRODUCT_ID,SUBS_QUANTITY,DELIVERY_QUANTITY \
FROM LT_CUSTOMER_SUBS_DELIVERIES WHERE SUBS_ID = ?

getSubsDeliveryById  = 	SELECT sd.*, cc.collected_quantity as containers_Collected, pm.PRODUCT_NAME \
	    ,pm.PRODUCT_IMAGE,um.USER_NAME ,  \
	   concat(um.FLAT_NO,', ',um.ADDRESS,', ',um.AREA) as ADDRESS  \
	  ,pm.collect_container, lcs.subscription_type  \
	FROM  lt_customer_subs lcs, LT_CUSTOMER_SUBS_DELIVERIES sd \
	LEFT JOIN lt_customer_cont_collections cc on cc.delivery_id  = sd.delivery_id  \
	LEFT JOIN LT_PRODUCTS pm ON sd.PRODUCT_ID = pm.PRODUCT_ID  \
	LEFT JOIN LT_MAST_USERS um ON sd.USER_ID = um.USER_ID  \
	where lcs.subs_id = sd.subs_id  \
	and lcs.supplier_id = sd.supplier_id  \
	and sd.DELIVERY_ID  = ? 


getSubsDeliveryByDeliveryIdSupId  = SELECT * FROM LT_CUSTOMER_SUBS_DELIVERIES sd \
		WHERE sd.DELIVERY_ID  = ? and sd.supplier_id = ?

getSubsDeliveryById_  = 	SELECT sd.*, pm.PRODUCT_NAME ,pm.PRODUCT_IMAGE,um.USER_NAME , \
concat(um.FLAT_NO,', ',um.ADDRESS,', ',um.AREA) as ADDRESS ,pm.collect_container \
FROM LT_CUSTOMER_SUBS_DELIVERIES sd \
LEFT JOIN LT_PRODUCTS pm ON sd.PRODUCT_ID = pm.PRODUCT_ID \
LEFT JOIN LT_MAST_USERS um ON sd.USER_ID = um.USER_ID \
WHERE sd.DELIVERY_ID  = ?


getSubsDeliveryByCustId = SELECT DELIVERY_ID,DELIVERY_DATE,PRODUCT_ID,SUBS_QUANTITY,DELIVERY_QUANTITY \
FROM LT_CUSTOMER_SUBS_DELIVERIES WHERE USER_ID = ?



getAllLtCustomerSubsBySupplier = SELECT cs.SUBS_ID,cs.SUBS_QUANTITY,cs.DELIVERY_TIME,cs.SUBSCRIPTION_TYPE, \
cs.SUBS_DELIVERY_DATE,cs.OFFER_ID,cs.CREATION_DATE,cs.START_DATE,cs.END_DATE,cs.USER_ID  \
FROM LT_CUSTOMER_SUBS cs LEFT JOIN LT_MAST_USERS um ON cs.USER_ID = um.USER_ID \
WHERE cs.SUPPLIER_ID = ? AND COALESCE(UPPER(BILLING_CYCLE),'XXX') = COALESCE(?,COALESCE(UPPER(BILLING_CYCLE),'XXX'))


calculateInvoiceAmount = SELECT SUM(delivery_quantity * invoice_rate) AS  LINE_AMOUNT \
		FROM LT_CUSTOMER_SUBS_DELIVERIES WHERE USER_ID = ? \
		AND DELIVERY_DATE >= ? \
		AND DELIVERY_DATE <= ? \
		AND STATUS = ? \
		AND INVOICE_ID IS NULL \
		AND subs_id not in (select coalesce (subs_id, -99 )  from lt_invoice_payments lip )

getPostpaidUsersForCreateInvoice = SELECT distinct usr.*  \
      FROM LT_MAST_USERS usr, lt_mast_suppliers lms, lt_customer_subs_deliveries lcsd \
	 where usr.SUPPLIER_ID = lms.supplier_id \
		AND UPPER(usr.USER_TYPE) = 'CUSTOMER' \
		AND usr.STATUS = 'ACTIVE' \
		and (lms.is_prepaid != 'Y' or  lms.is_prepaid is null) \
		and lcsd.invoice_id is null \
		AND UPPER(COALESCE(usr.BILLING_CYCLE, 'M')) = COALESCE( ? ,'M') \
		and lcsd.status = 'DELIVERED' \
		and lcsd.user_id = usr.user_id \
		and lcsd.supplier_id = lms.supplier_id 
		 


deliverySummaryByDeliveryBoyId_WITHSTATUS =SELECT a.* FROM ( select lcsd.product_id,lp.PRODUCT_IMAGE,lp.product_name,lp.PRODUCT_UOM, \
sum(lcsd.delivery_quantity) as delivery_quantity \
from lt_customer_subs_deliveries lcsd,lt_products lp,  lt_customer_subs lcs \
WHERE lp.product_id = lcsd.product_id AND lcsd.subs_id = lcs.subs_id \
AND  TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY')  LIKE COALESCE(?, TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY'))  \
AND lcs.delivery_time = ? \
AND COALESCE(UPPER(lcsd.STATUS),'xx') = COALESCE(?,COALESCE(UPPER(lcsd.STATUS),'xx'))  \
AND EXISTS (SELECT 1 FROM lt_delivery_agent_customers ldac   \
WHERE ldac.user_id = ? AND ldac.customer_id = lcsd.user_id)  \
GROUP BY lcsd.product_id,lp.product_name,lp.PRODUCT_IMAGE,lp.PRODUCT_UOM )a limit ? OFFSET ?



deliverySummaryByDeliveryAgent = SELECT a.* FROM ( select lcsd.product_id,lp.PRODUCT_IMAGE,lp.product_name,lp.PRODUCT_UOM, \
	sum(lcsd.delivery_quantity) as SUBS_QUANTITY,sum(lcsd.delivery_quantity ) delivery_quantity \
	from lt_customer_subs_deliveries lcsd,lt_products lp,  lt_customer_subs lcs \
	WHERE lp.product_id = lcsd.product_id \
		AND lcsd.subs_id = lcs.subs_id \
		and lcsd.DELIVERY_DATE = ? \
		AND lcs.delivery_time = ? \
		and lcs.supplier_id = lcsd.supplier_id \
		and lcsd.supplier_id = ? \
		and lcs.status = 'ACTIVE' \
		AND lcsd.SUBS_QUANTITY > 0 \
		and (lcsd.delivery_quantity > 0 OR lcsd.status = 'CANCELLED') \
		AND EXISTS (SELECT 1 FROM lt_delivery_agent_customers ldac   \
			WHERE ldac.user_id = ? AND ldac.customer_id = lcsd.user_id)  \
	GROUP BY lcsd.product_id,lp.product_name,lp.PRODUCT_IMAGE,lp.PRODUCT_UOM  ORDER BY lp.product_name )a limit ? OFFSET ?

	
deliverySummaryByDeliveryBoyId = SELECT a.* FROM ( select lcsd.product_id,lp.PRODUCT_IMAGE,lp.product_name,lp.PRODUCT_UOM, \
	sum(lcsd.delivery_quantity) as SUBS_QUANTITY,sum(lcsd.delivery_quantity ) delivery_quantity \
	from lt_customer_subs_deliveries lcsd,lt_products lp,  lt_customer_subs lcs \
	WHERE lp.product_id = lcsd.product_id \
		AND lcsd.subs_id = lcs.subs_id \
		AND  TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY')  LIKE COALESCE(? , TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY'))  \
		AND Upper(lcs.delivery_time) = ? \
		and lcs.supplier_id = lcsd.supplier_id \
		and lcsd.supplier_id = ? \
		AND lcsd.SUBS_QUANTITY > 0 \
		and (lcsd.delivery_quantity > 0 OR lcsd.status = 'CANCELLED') \
		AND EXISTS (SELECT 1 FROM lt_delivery_agent_customers ldac   \
			WHERE ldac.user_id = ? AND ldac.customer_id = lcsd.user_id)  \
	GROUP BY lcsd.product_id,lp.product_name,lp.PRODUCT_IMAGE,lp.PRODUCT_UOM  ORDER BY lp.product_name )a limit ? OFFSET ?
	
	
#	and lcs.status = 'ACTIVE' \
#,', Mob:',um.mobile_number

customerDeliverySummaryByDeliveryBoyId = SELECT a.* FROM \
	( select ldac.customer_seq, um.user_name, lcsd.product_id, lp.PRODUCT_IMAGE, lp.product_name, lcsd.DELIVERY_ID,  lcsd.delivery_mode, \
	lcsd.delivery_quantity as SUBS_QUANTITY, lcsd.delivery_quantity as delivery_quantity \
	, lp.PRODUCT_UOM, lcsd.CREATION_DATE, lcsd.LAST_UPDATE_DATE , lcsd.status status, \
	CONCAT(um.FLAT_NO,', ',um.ADDRESS,', ',um.AREA,', Mob:',um.mobile_number) AS ADDRESS , lcsd.INVOICE_ID, lcs.subscription_type \
	from lt_customer_subs_deliveries lcsd,lt_products lp ,lt_mast_users um, lt_customer_subs lcs, lt_delivery_agent_customers ldac   \
	WHERE lp.product_id = lcsd.product_id \
	AND lcsd.subs_id = lcs.subs_id \
	AND  TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY')  LIKE COALESCE( ? , TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY')) \
	AND ldac.customer_id = lcsd.user_id \
	AND um.USER_ID = ldac.customer_id \
	AND UPPER(lcs.delivery_time) = ? \
	and lcsd.subs_quantity > 0 \
	and (lcsd.delivery_quantity > 0 OR lcsd.status = 'CANCELLED') \
	and lcsd.supplier_id =  ? \
	AND ldac.user_id = ? \
	AND COALESCE(UPPER(lcsd.STATUS),'xx') = COALESCE( ? , COALESCE(UPPER(lcsd.STATUS),'xx'))) \
	a  ORDER BY to_number( a.customer_seq, '9999999.99' ), a.DELIVERY_ID  limit ? OFFSET ?


customerDeliverySummaryByDeliveryBoyId_v1 = SELECT a.* FROM \
	( select ldac.customer_seq, um.user_name, lcsd.product_id, lp.PRODUCT_IMAGE, lp.product_name, lcsd.DELIVERY_ID,  lcsd.delivery_mode, \
	lcsd.delivery_quantity as SUBS_QUANTITY, lcsd.delivery_quantity as delivery_quantity \
	, lp.PRODUCT_UOM, lcsd.CREATION_DATE, lcsd.LAST_UPDATE_DATE , lcsd.status status,  \
	CONCAT(um.FLAT_NO,', ',um.ADDRESS,', ',um.AREA ) AS ADDRESS , um.mobile_number,  lcsd.INVOICE_ID, lcs.subscription_type \
	from lt_customer_subs_deliveries lcsd, lt_products lp , lt_mast_users um, lt_customer_subs lcs, lt_delivery_agent_customers ldac   \
	WHERE lp.product_id = lcsd.product_id \
	AND lcsd.subs_id = lcs.subs_id \
	AND  TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY')  LIKE COALESCE( ? , TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY')) \
	AND ldac.customer_id = lcsd.user_id \
	AND um.USER_ID = ldac.customer_id \
	AND UPPER(lcs.delivery_time) = ? \
	and lcsd.subs_quantity > 0  \
	and (lcsd.delivery_quantity > 0 OR lcsd.status = 'CANCELLED') \
	and lcsd.supplier_id =  ? \
	AND ldac.user_id = ? \
	AND COALESCE(UPPER(lcsd.STATUS),'xx') = COALESCE( ? , COALESCE(UPPER(lcsd.STATUS),'xx'))) \
	a  ORDER BY to_number( a.customer_seq, '9999999.99' ), a.DELIVERY_ID  limit ? OFFSET ?

#	GROUP BY ldac.customer_seq,um.user_name, lcsd.product_id, lp.product_name, lp.PRODUCT_IMAGE, lp.PRODUCT_UOM,  lcsd.delivery_mode, \
#	CONCAT(um.FLAT_NO,', ',um.ADDRESS,', ',um.AREA,', Mob:',um.mobile_number ), lcsd.DELIVERY_ID ,lcsd.CREATION_DATE,lcsd.LAST_UPDATE_DATE,lcsd.INVOICE_ID  ) \

getDailySubsByUser_06-03-2020 = select lcsd.product_id,lp.PRODUCT_IMAGE,lp.product_name,lcsd.DELIVERY_ID,lcsd.STATUS,lcsd.subs_quantity, \
sum(lcsd.delivery_quantity) as delivery_quantity,lp.PRODUCT_UOM,lcsd.VACATION_ID,lcs.LAST_UPDATE_DATE \
from lt_customer_subs_deliveries lcsd,lt_products lp ,lt_customer_subs lcs \
WHERE lp.product_id = lcsd.product_id AND lcsd.subs_id = lcs.subs_id \
AND lcsd.DELIVERY_DATE = ?  \
AND lcsd.USER_ID = ? \
AND COALESCE(UPPER(lcsd.STATUS),'xx') = COALESCE(null,COALESCE(UPPER(lcsd.STATUS),'xx')) \
GROUP BY lcsd.product_id,lp.product_name,lp.PRODUCT_IMAGE,lcsd.DELIVERY_ID,lcsd.STATUS,lp.PRODUCT_UOM, \
lcsd.VACATION_ID,lcs.LAST_UPDATE_DATE,lcsd.subs_quantity \
ORDER BY lcs.LAST_UPDATE_DATE ASC

#Original query
#getDailySubsByUser = select TO_CHAR(FROM_TIME ,'HH24:MI') FROM_TIME \
#    , TO_CHAR(TO_TIME ,'HH24:MI') TO_TIME \
#    , TO_CHAR(time_limit ,'HH24:MI') time_limit \
#    , lcs.delivery_time \
#    , lcs.start_date \
#    , lcs.end_date \
#    , lcsd.subs_id, lcsd.product_id, lp.PRODUCT_IMAGE, lp.product_name \
#    , lcsd.DELIVERY_ID, lcsd.STATUS, lcs.subs_quantity \
#	, lcsd.delivery_quantity as delivery_quantity \
#	, lp.PRODUCT_UOM, lcsd.VACATION_ID, lcs.LAST_UPDATE_DATE \
#	, lcs.subscription_type  \
#from lt_customer_subs_deliveries lcsd,lt_products lp \
#    ,lt_customer_subs lcs left join lt_supplier_delivery_timings sdt \
#        on sdt.delivery_time = lcs.delivery_time  and sdt.supplier_id = lcs.supplier_id \
#WHERE lp.product_id = lcsd.product_id AND lcsd.subs_id = lcs.subs_id \
#	and lcsd.status != 'CANCELLED' \
#	and lcsd.supplier_id = lcs.supplier_id \
#    and lp.supplier_id = lcs.supplier_id \
#    AND lcsd.DELIVERY_DATE = ?  \
#    AND lcsd.USER_ID = ? \
#    and lcs.supplier_id = ? \
#	ORDER BY lcs.LAST_UPDATE_DATE asc
	
getDailySubsByUser = select TO_CHAR(FROM_TIME ,'HH24:MI') FROM_TIME \
    , TO_CHAR(TO_TIME ,'HH24:MI') TO_TIME \
    , TO_CHAR(time_limit ,'HH24:MI') time_limit \
    , lcs.delivery_time \
    , lcs.start_date \
    , lcs.end_date \
    , lcsd.subs_id, lcsd.product_id, lp.PRODUCT_IMAGE, lp.product_name \
    , lcsd.DELIVERY_ID, lcsd.STATUS, lcs.subs_quantity \
	, lcsd.delivery_quantity as delivery_quantity \
	, lp.PRODUCT_UOM, lcsd.VACATION_ID, lcs.LAST_UPDATE_DATE \
	, lcs.subscription_type  \
from lt_customer_subs_deliveries lcsd,lt_products lp \
    ,lt_customer_subs lcs left join lt_supplier_delivery_timings sdt \
        on sdt.delivery_time = lcs.delivery_time  and sdt.supplier_id = lcs.supplier_id \
WHERE lp.product_id = lcsd.product_id AND lcsd.subs_id = lcs.subs_id \
	and lcsd.status != 'CANCELLED' \
	and lcsd.supplier_id = lcs.supplier_id \
    and lp.supplier_id = lcs.supplier_id \
    AND lcsd.DELIVERY_DATE = ?  \
    AND lcsd.USER_ID = ? \
	ORDER BY lcs.LAST_UPDATE_DATE asc

#AND COALESCE(UPPER(lcsd.STATUS),'xx') = COALESCE(null,COALESCE(UPPER(lcsd.STATUS),'xx')) \



getAllActiveUsersBySupplier = SELECT * FROM LT_MAST_USERS WHERE SUPPLIER_ID = ? \
		AND UPPER(USER_TYPE) = ? \
		AND STATUS = 'ACTIVE' \
		AND COALESCE(UPPER(BILLING_CYCLE),'M') = COALESCE(?,COALESCE(UPPER(BILLING_CYCLE),'M'))

 
deliverySummaryStatus = SELECT COUNT(lcsd.delivery_quantity) as delivery_quantity, lcsd.STATUS \
from lt_customer_subs_deliveries lcsd,lt_products lp ,lt_mast_users um,lt_customer_subs lcs,lt_delivery_agent_customers ldac  \
WHERE lp.product_id = lcsd.product_id AND lcsd.subs_id = lcs.subs_id  \
AND lcsd.DELIVERY_DATE = ? \
AND UPPER(lcs.delivery_time) = UPPER(?) \
and ((lcsd.delivery_quantity > 0  and lcsd.status = 'ACTIVE') or lcsd.status = 'CANCELLED' or lcsd.status = 'DELIVERED')  \
AND ldac.user_id = ? AND ldac.customer_id = lcsd.user_id AND um.USER_ID = ldac.customer_id  \
GROUP BY lcsd.STATUS


getDeliveryRecordsByInvoiceId = select lcsd.delivery_date,lp.product_name,lp.product_uom as uom, \
lcsd.delivery_quantity,lcsd.invoice_rate, lcsd.line_amount \
from lt_customer_subs_deliveries lcsd left join lt_products lp  \
on lcsd.product_id = lp.product_id \
where lcsd.invoice_id = ? and lcsd.delivery_quantity > 0 order by lcsd.delivery_date asc

getDeliveryRecordsBySubId = select lcsd.delivery_date,lp.product_name,lp.product_uom as uom, \
lcsd.delivery_quantity,lcsd.invoice_rate, lcsd.delivery_quantity * lcsd.invoice_rate as line_amount \
from lt_customer_subs_deliveries lcsd left join lt_products lp  \
on lcsd.product_id = lp.product_id \
where lcsd.subs_id = ? and lcsd.delivery_quantity > 0 


getVacation = SELECT * FROM LT_VACATION_PERIOD \
WHERE VACATION_ID = ? 


getVacationByUser = SELECT * FROM LT_VACATION_PERIOD \
WHERE USER_ID = ? AND STATUS = 'ACTIVE'  AND  END_DATE >= ? \
ORDER BY VACATION_ID DESC



exportDeliveriesByDeliveryAgent = select ldac.user_id, \
   ldac.customer_seq, \
   um.user_name, \
   lp.product_name, \
   lcsd.delivery_mode, \
   sum(lcsd.delivery_quantity) as delivery_quantity , \
   lp.PRODUCT_UOM,lcsd.SUBS_QUANTITY, \
   lcsd.LAST_UPDATE_DATE,  \
   CONCAT(um.FLAT_NO,',',um.ADDRESS,',',um.AREA ) AS ADDRESS , \
   lcsd.STATUS \
   , lcs.delivery_time \
from lt_customer_subs_deliveries lcsd, \
        lt_products lp , \
        lt_mast_users um, \
        lt_customer_subs lcs, \
        lt_delivery_agent_customers ldac  \
WHERE lp.product_id = lcsd.product_id  \
    AND lcsd.subs_id = lcs.subs_id \
    AND  TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY')  LIKE COALESCE(?, TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY'))  \
	AND lcs.delivery_time = ?  \
  	and lcsd.subs_quantity != 0  \
	AND ldac.user_id = ? \
	AND ldac.customer_id = lcsd.user_id \
	AND um.USER_ID = ldac.customer_id \
	AND COALESCE(UPPER(lcsd.STATUS),'xx') = COALESCE(?,COALESCE(UPPER(lcsd.STATUS),'xx')) \
		GROUP BY ldac.customer_seq,um.user_name,lp.product_name,lp.PRODUCT_UOM,  lcsd.delivery_mode,  \
		CONCAT(um.FLAT_NO,',',um.ADDRESS,',',um.AREA ),lcsd.SUBS_QUANTITY   ,lcsd.STATUS,lcs.delivery_time,ldac.user_id, lcsd.LAST_UPDATE_DATE \
	ORDER BY to_number(customer_seq, '99999') 

calculateInvoiceAmountForSubs = select sum(line_amount) \
from lt_customer_subs_deliveries where subs_id = ? and status = 'DELIVERED' and invoice_id is null \
and delivery_date between ? and ?


temp_query = select lcsd.delivery_date, lcsd.SUPPLIER_ID \
   from lt_customer_subs_deliveries lcsd  , lt_customer_subs lcs  \
    WHERE lcsd.subs_id =lcs.subs_id \
	and (lcsd.delivery_date >= current_date)  \
	and  lcs.delivery_time = (select DELIVERY_TIME from lt_supplier_delivery_timings lsdt \
						  where from_time >= current_time and supplier_id = lcsd.supplier_id order by DELIVERY_TIME offset 0 limit 1 )  \
	group by lcsd.delivery_date, lcs.delivery_time ,  lcsd.SUPPLIER_ID  \
	order by lcsd.delivery_date \
	limit 1

getNextDeliveryDateTime_old = select lcsd.delivery_date, lcs.delivery_time, current_time  \
		from lt_customer_subs_deliveries lcsd , lt_customer_subs lcs  \
		where lcsd.supplier_id = ?  \
		and lcsd.subs_id =lcs.subs_id \
and (lcsd.delivery_date >= ?)  \
and  lcs.delivery_time = (select DELIVERY_TIME from lt_supplier_delivery_timings lsdt \
						  where to_char(to_time,'HH24:MI') >= ? and supplier_id = lcsd.supplier_id order by DELIVERY_TIME offset 0 limit 1 )  \
group by lcsd.delivery_date,lcs.delivery_time  \
order by lcsd.delivery_date \
limit 1


getNextDeliveryDateTime_old = select   lcsd.delivery_date , \
  concat(lcs.delivery_time, ' (', to_char(dt.from_time,'HH:MI AM'),'-', to_char(dt.to_time,'HH:MI AM'), ')') as delivery_time \
		from lt_customer_subs_deliveries lcsd \
		 , lt_customer_subs lcs \
		, (select DELIVERY_TIME, supplier_id, from_time, to_time  from lt_supplier_delivery_timings lsdt \
						  where to_char(to_time,'HH24:MI') >= ? \
						  and  supplier_id = ? \
						  order by DELIVERY_TIME offset 0 limit 1 ) dt \
		where lcsd.supplier_id = dt.supplier_id \
		and lcsd.subs_id =lcs.subs_id \
	and  lcsd.delivery_date >= ?	\
	and  lcs.delivery_time = dt.DELIVERY_TIME  \
	group by lcsd.delivery_date, lcs.delivery_time, dt.from_time, dt.to_time  \
	order by lcsd.delivery_date \
	limit 1
	
getNextDeliveryDateTime = select  delivery_time, concat(delivery_time, ' (', to_char(from_time,'HH:MI AM'),'-', to_char(to_time,'HH:MI PM'), ')') as show_time \
	   from lt_supplier_delivery_timings lsdt \
		  where to_char(to_time,'HH24:MI') >= ? \
		  and  supplier_id = ? \
		  order by DELIVERY_TIME offset 0 limit 1	
	
getNextDeliveryDateTime_else_old = select concat(delivery_time, ' (', to_char(from_time,'HH:MI AM'),'-', to_char(to_time,'HH:MI PM'), ')') as delivery_time \
	   from lt_supplier_delivery_timings lsdt \
		  where supplier_id = ? \
		  order by DELIVERY_TIME offset 0 limit 1

customerDeliverySummaryTotal_24-2-2020 = select count(um.user_name) \
from lt_customer_subs_deliveries lcsd,lt_products lp ,lt_mast_users um,lt_customer_subs lcs,lt_delivery_agent_customers ldac  \
WHERE lp.product_id = lcsd.product_id AND lcsd.subs_id = lcs.subs_id \
AND  TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY')  LIKE COALESCE(?, TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY'))  \
AND lcs.delivery_time = ? and delivery_quantity != 0 \
AND ldac.user_id = ? AND ldac.customer_id = lcsd.user_id AND um.USER_ID = ldac.customer_id \
AND COALESCE(UPPER(lcsd.STATUS),'xx') = COALESCE(?,COALESCE(UPPER(lcsd.STATUS),'xx')) \
GROUP BY ldac.customer_seq,um.user_name,lcsd.product_id,lp.product_name,lp.PRODUCT_IMAGE,lp.PRODUCT_UOM,  lcsd.delivery_mode, \
CONCAT(um.FLAT_NO,',',um.ADDRESS,',',um.AREA ),lcsd.DELIVERY_ID ,lcsd.SUBS_QUANTITY,lcsd.CREATION_DATE,lcsd.LAST_UPDATE_DATE,lcsd.INVOICE_ID


customerDeliverySummaryTotal_old = select count(um.user_name) \
	from lt_customer_subs_deliveries lcsd, lt_products lp , lt_mast_users um, lt_customer_subs lcs, lt_delivery_agent_customers ldac  \
	WHERE lp.product_id = lcsd.product_id \
	AND lcsd.subs_id = lcs.subs_id \
	AND  TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY')  LIKE COALESCE(?, TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY'))  \
	AND ldac.customer_id = lcsd.user_id \
	AND um.USER_ID = ldac.customer_id \
	AND lcs.delivery_time = ? \
	and lcsd.subs_quantity > 0 \
	AND ldac.user_id = ? \
	AND COALESCE(UPPER(lcsd.STATUS),'xx') = COALESCE(?,COALESCE(UPPER(lcsd.STATUS),'xx')) \
	GROUP BY ldac.customer_seq,um.user_name,lcsd.product_id,lp.product_name,lp.PRODUCT_IMAGE,lp.PRODUCT_UOM,  lcsd.delivery_mode, \
	CONCAT(um.FLAT_NO,',',um.ADDRESS,',',um.AREA ),lcsd.DELIVERY_ID ,lcsd.SUBS_QUANTITY,lcsd.CREATION_DATE,lcsd.LAST_UPDATE_DATE,lcsd.INVOICE_ID

customerDeliverySummaryTotal = select count( lcsd.DELIVERY_ID) \
	from lt_customer_subs_deliveries lcsd \
   , lt_customer_subs lcs \
   , lt_delivery_agent_customers ldac  \
WHERE  1=1 \
	and lcsd.subs_id = lcs.subs_id \
	and TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY')  LIKE COALESCE( ? , TO_CHAR(lcsd.DELIVERY_DATE,'DD-MM-YYYY'))  \
	AND ldac.customer_id = lcsd.user_id \
	AND UPPER(lcs.delivery_time) = ?  \
	and ldac.supplier_id = lcsd.supplier_id \
	and lcsd.subs_quantity > 0 \
	AND lcsd.STATUS =  ? \
	AND ldac.user_id = ? \
	and lcsd.supplier_id = ? 
	


getAllActiveSubsBySubsDelDateAndUser =   SELECT cs.SUPPLIER_ID,cs.SUBS_ID,cs.USER_ID,cs.SUBS_QUANTITY,cs.DELIVERY_TIME,cs.SUBS_DELIVERY_DATE, \
cs.SUBSCRIPTION_TYPE,cs.STATUS,case when cs.status = 'PENDING' then 1 \
          when cs.status = 'ACTIVE' then 2 \
          else 3 end status_order, \
cs.PRODUCT_ID, cs.SUBS_DELIVERY_DATE ,pm.PRODUCT_NAME,pm.PRODUCT_IMAGE,pm.PRODUCT_UOM, \
cs.MONDAY,cs.TUESDAY,cs.WEDNESDAY,cs.THURSDAY,cs.FRIDAY,cs.SATURDAY,cs.SUNDAY,cs.START_DATE,cs.OFFER_ID  \
FROM LT_CUSTOMER_SUBS cs LEFT JOIN LT_PRODUCTS pm ON cs.PRODUCT_ID = pm.PRODUCT_ID  \
WHERE cs.USER_ID = ? AND cs.SUBS_DELIVERY_DATE = ? AND cs.SUBSCRIPTION_TYPE != 'ONCE' AND cs.STATUS NOT IN ('CANCELLED','REJECTED') \
ORDER BY status_order



getTomorrowsNextDeliveryDateTime = select lcsd.delivery_date,lcs.delivery_time,current_time  \
from lt_customer_subs_deliveries lcsd ,lt_customer_subs lcs  \
where lcsd.supplier_id = ?  \
and lcsd.subs_id =lcs.subs_id \
and (lcsd.delivery_date >= current_date+1)  \
and  lcs.delivery_time = (select DELIVERY_TIME from lt_supplier_delivery_timings lsdt \
                         where 1=1 and from_time >= '00:00:00' \
 and supplier_id = lcsd.supplier_id \
     offset 0 limit 1)  \
group by lcsd.delivery_date,lcs.delivery_time \
order by lcsd.delivery_date \
limit 1

getAllActiveVacationBySupplier_12_2_2020 = select * from LT_VACATION_PERIOD \
where STATUS = 'ACTIVE' AND END_DATE < CURRENT_DATE  AND SUPPLIER_ID = ?

getAllActiveVacationBySupplier = select * from LT_VACATION_PERIOD \
		where STATUS = 'ACTIVE' AND END_DATE = ? 


getSubsDeliveriesBetDates  = SELECT lcsd.* FROM lt_customer_subs_deliveries lcsd  \
where lcsd.USER_ID = ? AND lcsd.delivery_date between ? AND ? \
AND lcsd.STATUS = 'DELIVERED' AND INVOICE_ID is null

getSubsDeliveriesCountByDatesAndSupplierId  = SELECT count(*) \
		FROM lt_customer_subs_deliveries lcsd  \
		where  lcsd.supplier_id = ?  \
		AND lcsd.delivery_date between ? AND ? \
		AND lcsd.STATUS = 'DELIVERED' \
		AND INVOICE_ID is null

getAllActiveSubsCountBySupplier_old =  SELECT count(cs.subs_id ) \
   FROM LT_CUSTOMER_SUBS cs \
   WHERE cs.supplier_id = ? \
    AND cs.subscription_type != 'ONCE' \
    AND cs.status = 'ACTIVE' 
    
getAllActiveSubsCountBySupplier = SELECT count(Lcs.subs_id ) \
  FROM lt_customer_subs lcs \
  WHERE lcs.supplier_id = ? \
   	AND lcs.status = 'ACTIVE' \
  	and exists (select 1 from lt_customer_subs_deliveries lcsd \
              WHERE lcsd.supplier_id = lcs.supplier_id \
              and lcs.subs_id = lcsd.subs_id and status = 'ACTIVE')
    
getAllActiveUsersCountBySupplier = SELECT count(user_id ) \
   FROM LT_MAST_USERS \
  WHERE SUPPLIER_ID = ? \
	AND UPPER(USER_TYPE) = 'CUSTOMER' \
    AND STATUS = 'ACTIVE' 
    
getMonthlyWeeklyCustomerSubsCount = SELECT  count (cs.subs_id ) \
    FROM LT_CUSTOMER_SUBS cs \
   where cs.SUPPLIER_ID = ? \
    AND cs.STATUS = 'PENDING' 
    
    
getPrepaymentSubsDeliveries = SELECT  lcsd.subs_id, lcsd.supplier_id, lcsd.user_id , lcsd.delivery_id, lcsd.line_amount  \
		FROM lt_customer_subs_deliveries lcsd , lt_invoice_payments lip, lt_customer_subs cs \
		where 1=1 \
			and cs.subs_id = lcsd.subs_id \
		    and cs.supplier_id = lcsd.supplier_id \
		    and cs.subscription_type = 'ONCE' \
			and lcsd.subs_id  = lip.subs_id \
			and lcsd.user_id = lip.user_id  \
			and lip.subs_id is not null \
			AND lcsd.STATUS = 'DELIVERED' \
			and lip.supplier_id = lcsd.supplier_id \
			AND lcsd.INVOICE_ID IS null


getPrepaymentSubsDeliveriesByUser = SELECT  lcsd.subs_id, lcsd.supplier_id, lcsd.user_id , lcsd.delivery_id \
         , lcsd.delivery_quantity * lcsd.invoice_rate as line_amount  --lcsd.line_amount   \
		FROM lt_customer_subs_deliveries lcsd , lt_invoice_payments lip, lt_customer_subs cs \
		where 1=1  \
			and cs.subs_id = lcsd.subs_id  \
		    and cs.supplier_id = lcsd.supplier_id  \
		    and cs.subscription_type = 'ONCE'  \
			and lcsd.subs_id  = lip.subs_id  \
			and lcsd.user_id = lip.user_id   \
			and lip.subs_id is not null  \
			and lip.supplier_id = lcsd.supplier_id  \
			and cs.user_id = ? \
			and cs.supplier_id = ?  \
			AND lcsd.INVOICE_ID IS null


# select lmu.user_name "Customer",lmu.mobile_number "Mobile Number", \
# lp.product_name "Product Name",lcs.subs_quantity "Quantity",lcs.subscription_type "Order Type", lcs.status,CONCAT(lmu.flat_no,', ',lmu.address,', ',lmu.area) "Customer Address"\
	
activeOrdersReport =  select lmu.user_name , lmu.mobile_number , lp.product_name, lcs.subs_quantity, \
	   lcs.subscription_type ,  lcs.status, CONCAT(lmu.flat_no,', ',lmu.address,', ',lmu.area) customer_address \
	from lt_mast_users lmu \
	    ,lt_customer_subs lcs \
	    ,lt_products lp \
	where 1=1 \
	and   lcs.supplier_id = lmu.supplier_id \
	and   lcs.user_id = lmu.user_id \
	and   lcs.product_id = lp.product_id \
	and   lcs.status = 'ACTIVE' \
	and   exists (select 1 from lt_customer_subs_deliveries lcsd where lcsd.subs_id = lcs.subs_id and lcsd.status = 'ACTIVE') \
	and lmu.supplier_id = ? \

getCollectionLedger = SELECT a.* FROM ( select to_char(creation_date, 'DD-Mon HH:MI') as delivery_time, delivery_quantity, collected_quantity as containers_collected  \
 	from lt_customer_cont_collections \
 where product_id = ? \
 	and status = 'DELIVERED' \
 	and user_id = ? \
 	and supplier_id = ? \
 order by cont_collection_id desc )a limit ? OFFSET ?

getCollectionLedger_old = SELECT a.* FROM ( select lcsd.delivery_date, lcsd.delivery_quantity, lccc.collected_quantity as containers_collected \
 from lt_customer_subs_deliveries lcsd \
  LEFT JOIN lt_customer_cont_collections lccc ON lcsd.delivery_id = lccc.delivery_id \
 where  1=1 \
	and lcsd.status = 'DELIVERED' \
 	and lcsd.product_id = ? \
 	and lcsd.user_id = ? \
	and lcsd.supplier_id = ? \
  order by delivery_date desc )a limit ? OFFSET ?  
  
getCollectionLedgerCount =    select count(creation_date)  \
 	from lt_customer_cont_collections \
 where product_id = ? \
 	and status = 'DELIVERED' \
 	and user_id = ? \
 	and supplier_id = ?
    

getCollectionBalanceLedgerN = select sum(collected_quantity) - sum( delivery_quantity) as balance  \
 	from lt_customer_cont_collections \
 	where status = 'DELIVERED' \
 		and product_id = ? \
 		and user_id = ?	\
 		and supplier_id = ?

getCollectionBalanceLedgerY = select  sum( delivery_quantity) - sum(collected_quantity) as balance  \
 	from lt_customer_cont_collections \
 	where status = 'DELIVERED' \
 		and product_id = ? \
 		and user_id = ?	\
 		and supplier_id = ?	
	
	
isDeliveryAvailable_old = select count(subs_id) from lt_customer_subs lcsd \
	where status = ? \
	and supplier_id = ?	\
	and subs_id = ?
	
isDeliveryAvailable = select count( csd.delivery_id ) from lt_customer_subs cs, lt_customer_subs_deliveries csd \
	where cs.status = ? \
	and cs.subs_id = csd.subs_id \
	and cs.supplier_id = ?\
	and cs.subs_id = ? \
	and cs.supplier_id = csd.supplier_id 
    
	#and cs.subs_quantity = csd.subs_quantity \
	
getStartDate = select min(delivery_date) from lt_customer_subs_deliveries lcsd \
	where  1 = 1\
 	and  delivery_date  > ? \
 	and  delivery_date  >= ? \
 	and subs_id = ? \
 	and supplier_id = ?
 	
update_customer_subscription = update lt_customer_subs_deliveries set delivery_date =  ?, \
   delivery_quantity = ? , subs_quantity = ?  \
   , status = ? , invoice_rate = ? \
   , last_update_date = ?  \
   where 1=1  \
   and delivery_date >= ? \
   and subs_id = ? \
   and user_id = ? \
   and supplier_id = ?
   
   
get_subscriber_count =   select count (distinct lcs.user_id ) \
       from lt_customer_subs lcs, lt_customer_subs_deliveries lcsd \
       where lcs.status = 'ACTIVE' \
           and lcsd.status = 'ACTIVE' \
           and lcsd.delivery_date > current_date-1 \
           and lcsd.subs_id = lcs.subs_id \
           and lcsd.supplier_id = lcs.supplier_id \
           and lcsd.supplier_id = ?
            
get_subscribers_old = select a.* from (	\
	select lmu.user_id, lmu.user_name, lmu.flat_no, lmu.society_name, lmu.landmark \
	     , lmu.address, lmu.area, lsc.city , lss.supplier_state  \
	from   lt_mast_users lmu, lt_supplier_cities lsc , lt_supplier_states lss  \
	    where 1=1  \
	       and lsc.city_id = lmu.city_id \
	       and lss.state_id = lmu.state_id  \
	       and upper(CONCAT(lmu.USER_NAME,lmu.AREA,lsc.city,lmu.flat_no,lmu.address)) like ? \
		  and lmu.start_date <= current_date  \
	      and (lmu.end_date is null OR lmu.end_date >= current_date) \
	      and lmu.user_type = 'CUSTOMER' \
	      and lmu.status = 'ACTIVE' \
	       and user_id in (select lcs.user_id \
	       from lt_customer_subs lcs, lt_customer_subs_deliveries lcsd  \
	       where lcs.status = 'ACTIVE'  \
	           and lcsd.status = 'ACTIVE'  \
	           and lcsd.delivery_date > current_date-1 \
	           and lcsd.subs_id = lcs.subs_id \
	           and lcsd.supplier_id = lcs.supplier_id \
	           and lcs.user_id = lmu.user_id)  \
	      and lmu.supplier_id = ?  \
	      order by lmu.user_name \
	)a limit ? OFFSET ?

   
get_subscribers = select a.* from ( \
    select  lmu.user_id, lmu.user_name, lmu.flat_no, lmu.society_name, lmu.landmark \
    , lmu.address, lmu.area, lsc.city , lss.supplier_state   \
from   lt_mast_users lmu, lt_supplier_cities lsc , lt_supplier_states lss \
   where 1=1   \
     and lsc.city_id = lmu.city_id   \
     and lss.state_id = lmu.state_id   \
     and upper(CONCAT(lmu.USER_NAME,lmu.AREA,lsc.city,lmu.flat_no,lmu.address)) like ?  \
     and lmu.start_date <= current_date   \
     and (lmu.end_date is null OR lmu.end_date >= current_date)   \
     and lmu.user_type = 'CUSTOMER'  \
     and lmu.status = 'ACTIVE'   \
     and exists (select 1  \
     from lt_customer_subs_deliveries lcsd   \
      where  lcsd.status = 'ACTIVE'   \
          and lcsd.delivery_date > current_date-1 \
          and lcsd.user_id = lmu.user_id \
          and lcsd.supplier_id = lmu.supplier_id) \
     and lmu.supplier_id = ? \
     order by lmu.user_name	 \
     )a limit ? OFFSET ?        
    
get_unsubscriber_count =  select count(lmu.user_id) \
	from   lt_mast_users lmu, lt_supplier_cities lsc , lt_supplier_states lss   \
     where 1=1  \
        and lsc.city_id = lmu.city_id \
        and lss.state_id = lmu.state_id \
        and user_id not in (select lcs.user_id   \
        from lt_customer_subs lcs, lt_customer_subs_deliveries lcsd  \
        where lcs.status = 'ACTIVE'  \
       		and lcsd.status = 'ACTIVE' \
       		and lcsd.delivery_date > current_date-1 \
       		and lcsd.subs_id = lcs.subs_id  \
       		and lcsd.user_id = lcs.user_id  \
       		and lcsd.supplier_id = lcs.supplier_id \
            and lcs.user_id = lmu.user_id \
       		and lcs.supplier_id = lmu.supplier_id) \
       and lmu.start_date <= current_date \
       and (lmu.end_date is null OR lmu.end_date >= current_date) \
       and lmu.user_type = 'CUSTOMER' \
       and upper(CONCAT(lmu.USER_NAME,lmu.AREA,lsc.city,lmu.flat_no,lmu.address)) like ? \
       and lmu.status = 'ACTIVE' \
       and lmu.supplier_id = ?
       
get_unsubscribers_old = select a.* from (	\
	select lmu.user_id, lmu.user_name, lmu.flat_no, lmu.society_name, lmu.landmark \
	     , lmu.address, lmu.area, lsc.city , lss.supplier_state  \
	from   lt_mast_users lmu, lt_supplier_cities lsc , lt_supplier_states lss  \
	    where 1=1  \
	       and lsc.city_id = lmu.city_id \
	       and lss.state_id = lmu.state_id  \
	       and upper(CONCAT(lmu.USER_NAME,lmu.AREA,lsc.city,lmu.flat_no,lmu.address)) like ? \
		  and lmu.start_date <= current_date  \
	      and (lmu.end_date is null OR lmu.end_date >= current_date) \
	      and lmu.user_type = 'CUSTOMER' \
	      and lmu.status = 'ACTIVE' \
	       and user_id not in (select lcs.user_id \
	       from lt_customer_subs lcs, lt_customer_subs_deliveries lcsd  \
	       where lcs.status = 'ACTIVE'  \
	           and lcsd.status = 'ACTIVE'  \
	           and lcsd.delivery_date > current_date-1 \
	           and lcsd.subs_id = lcs.subs_id \
	           and lcsd.supplier_id = lcs.supplier_id \
	           and lcs.user_id = lmu.user_id)  \
	      and lmu.supplier_id = ?  \
	      order by lmu.user_name \
	)a limit ? OFFSET ? 

	   
#get_unsubscribers = select a.* from ( \
#    select  lmu.user_id, lmu.user_name, lmu.flat_no, lmu.society_name, lmu.landmark \
#    , lmu.address, lmu.area, lsc.city , lss.supplier_state   \
#from   lt_mast_users lmu, lt_supplier_cities lsc , lt_supplier_states lss \
#   where 1=1   \
#     and lsc.city_id = lmu.city_id   \
#     and lss.state_id = lmu.state_id   \
#     and upper(CONCAT(lmu.USER_NAME,lmu.AREA,lsc.city,lmu.flat_no,lmu.address)) like ?  \
#     and lmu.start_date <= current_date   \
#     and (lmu.end_date is null OR lmu.end_date >= current_date)   \
#     and lmu.user_type = 'CUSTOMER'  \
#     and lmu.status = 'ACTIVE'   \
#     and not exists (select 1  \
#     from lt_customer_subs_deliveries lcsd   \
#      where  lcsd.status = 'ACTIVE'   \
#          and lcsd.delivery_date > current_date-1 \
#          and lcsd.user_id = lmu.user_id \
#          and lcsd.supplier_id = lmu.supplier_id) \
#     and lmu.supplier_id = ? \
#     order by lmu.user_name	 \
#     )a limit ? OFFSET ?    
#	   

get_unsubscribers = select a.* from ( \
    select  lmu.user_id, lmu.user_name, lmu.flat_no, lmu.society_name, lmu.landmark \
    , lmu.address, lmu.area, lsc.city , lss.supplier_state   \
from   lt_mast_users lmu, lt_supplier_cities lsc , lt_supplier_states lss \
   where 1=1   \
     and lsc.city_id = lmu.city_id   \
     and lss.state_id = lmu.state_id   \
     and upper(CONCAT(lmu.USER_NAME,lmu.AREA,lsc.city,lmu.flat_no,lmu.address)) like ?  \
	and DATE(lmu.start_date) <= current_date   \
     and (DATE(lmu.end_date) is null OR DATE(lmu.end_date) >= current_date)   \
     and lmu.user_type = 'CUSTOMER'  \
     and lmu.status = 'ACTIVE'   \
     and not exists (select 1  \
     from lt_customer_subs_deliveries lcsd   \
      where  lcsd.status = 'ACTIVE'   \
          and lcsd.delivery_date > current_date-1 \
          and lcsd.user_id = lmu.user_id \
          and lcsd.supplier_id = lmu.supplier_id) \
     and lmu.supplier_id = ? \
     order by lmu.user_name	 \
     )a limit ? OFFSET ?    

	   
 order_history_count = select count(history_id) \
		 from lt_order_history  \
		 where user_id = ? \
		 and supplier_id = ? 
		 
order_history = select a.* from (  \
		select tital, description, amount, remark, creater, creation_date  \
		 from lt_order_history  \
		 where user_id = ? \
		 and supplier_id = ? \
		 order by creation_date desc \
		) a offset ? limit ?
		   
	   